<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>스마트 트레이더 v1</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/picocss@1.5.10/css/pico.min.css">
<style>
  body{ background:#0e1621; color:#e7eef7 }
  .wrap{ max-width:1100px; margin:auto }
  .card{ background:#121c27; border-radius:16px; padding:16px; margin:12px 0 }
  .pos{ color:#35d07f } .neg{ color:#ff5c5c }
  table{ font-size:14px }
  nav button{ margin-right:6px }
  .row{ display:flex; gap:12px; flex-wrap:wrap }
  .col{ flex:1 1 320px }
  .small{ font-size:12px; opacity:.8 }
</style>
</head>
<body>
<div class="wrap">
  <h3>스마트 트레이더</h3>
  <nav>
    <button data-tab="p">포트폴리오</button>
    <button data-tab="r">종목 비교/랭킹</button>
    <button data-tab="d">월별 배당</button>
    <button data-tab="n">뉴스 요약/번역</button>
    <button data-tab="a">가격 하락 알림</button>
  </nav>

  <section id="tab-p" class="card">
    <h5>보유 종목 입력</h5>
    <div class="row">
      <div class="col">
        <input id="sym" placeholder="티커 (예: AAPL, MSFT)">
      </div>
      <div class="col">
        <input id="qty" type="number" placeholder="수량">
      </div>
      <div class="col">
        <input id="avg" type="number" placeholder="평균매입가(USD)">
      </div>
      <div class="col">
        <button id="add">추가</button>
      </div>
    </div>

    <details>
      <summary>환율/세금/수수료/배당 재투자</summary>
      <div class="row">
        <div class="col"><label>USD→KRW <input id="fx" type="number" value="1350"></label></div>
        <div class="col"><button id="fxSync">다중 환율 동기화</button><span id="fxSrc" class="small"></span></div>
        <div class="col"><label>매도 수수료(%) <input id="fee" type="number" value="0.1"></label></div>
        <div class="col"><label>배당 원천세(%) <input id="wtax" type="number" value="15"></label></div>
        <div class="col"><label><input type="checkbox" id="reinvest"> 배당 재투자</label></div>
        <div class="col">
          <label>매수/매도 타이밍 지표
            <select id="signalSel">
              <option>RSI(14)</option><option>MA Cross(20/60)</option>
              <option>Shooting Star</option><option>Evening Star</option>
              <option>Bearish Engulfing</option><option>Bullish Gap</option>
            </select>
          </label>
        </div>
      </div>
    </details>

    <div class="row">
      <div class="col"><button id="recalc">재계산</button></div>
      <div class="col">
        <input type="file" id="csvFile" accept=".csv">
        <button id="csvLoad">CSV 불러오기</button>
        <button id="csvSave">CSV 저장</button>
      </div>
    </div>

    <table id="ptbl">
      <thead><tr><th>티커</th><th>수량</th><th>평균매입</th><th>현재가</th><th>P/L(USD)</th><th>현실 수익률(KRW)</th></tr></thead>
      <tbody></tbody>
    </table>
  </section>

  <section id="tab-r" class="card" hidden>
    <h5>가치 스크리너 (PER≤15, PBR≤1.5, PSR&lt;3, ROE≥15)</h5>
    <input id="universe" placeholder="스캔 대상 (쉼표구분)" value="AAPL,MSFT,GOOGL,AMZN,META,JNJ,MO,KO,PG,UL,NVDA,INTC,TXN,ORCL">
    <button id="scan">스캔</button>
    <table id="rtbl"><thead><tr><th>심볼</th><th>ROE</th><th>PER</th><th>PBR</th><th>PSR</th></tr></thead><tbody></tbody></table>
  </section>

  <section id="tab-d" class="card" hidden>
    <h5>월별 배당 합산</h5>
    <input id="divSym" placeholder="티커" value="MO">
    <button id="divFetch">조회</button>
    <table id="divTbl"><thead><tr><th>월</th><th>배당(USD)</th></tr></thead><tbody></tbody></table>
    <canvas id="divChart" height="120"></canvas>
  </section>

  <section id="tab-n" class="card" hidden>
    <h5>뉴스 자동요약/번역</h5>
    <input id="newsSym" placeholder="티커" value="AAPL">
    <button id="newsBtn">조회</button>
    <ul id="newsList"></ul>
  </section>

  <section id="tab-a" class="card" hidden>
    <h5>가격 하락 알림 설정</h5>
    <input id="alertSym" placeholder="티커" value="AAPL">
    <input id="alertAvg" type="number" placeholder="평균매입가(USD)">
    <input id="alertDrop" type="number" placeholder="하락기준 % (예: 8)">
    <button id="alertSave">저장</button>
    <p class="small">서버측 스케줄러가 15분마다 체크하여 문자 발송. (환경변수 ALERT_PORTFOLIO 사용)</p>
  </section>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="./app.js"></script>
</body>
</html>